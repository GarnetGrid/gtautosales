var DealerCenter;(function(e){(function(t){(function(t){var i;(function(e){e[e.Year=0]="Year",e[e.Make=1]="Make",e[e.Model=2]="Model",e[e.BodyType=3]="BodyType",e[e.Price=4]="Price",e[e.Drivetrain=5]="Drivetrain",e[e.Transmission=6]="Transmission",e[e.Mileage=7]="Mileage",e[e.ExteriorColor=8]="ExteriorColor",e[e.HighwayMPG=9]="HighwayMPG",e[e.CityMPG=10]="CityMPG",e[e.VehicleClass=11]="VehicleClass",e[e.Location=13]="Location",e[e.Cylinder=14]="Cylinder",e[e.Displacement=15]="Displacement",e[e.TransmissionDetail=16]="TransmissionDetail",e[e.VehicleType=17]="VehicleType",e[e.CustomStatus=18]="CustomStatus",e[e.VehicleLocation=19]="VehicleLocation",e[e.MakeModel=20]="MakeModel",e[e.InteriorColor=21]="InteriorColor",e[e.FuelType=22]="FuelType",e[e.TitleBrand=23]="TitleBrand",e[e.RequiredDownAmount=24]="RequiredDownAmount",e[e.InteriorColorType=25]="InteriorColorType",e[e.ExteriorColorType=26]="ExteriorColorType",e[e.DrivetrainType=27]="DrivetrainType",e[e.Equipment=28]="Equipment",e[e.Status=29]="Status",e[e.AutoCheck=30]="AutoCheck",e[e.CoachDesign=32]="CoachDesign",e[e.FloorPlan=33]="FloorPlan",e[e.NumberOfSlideouts=34]="NumberOfSlideouts",e[e.SleepingCount=35]="SleepingCount",e[e.Image=99]="Image"})(i=t.VehicleOptionTypes||(t.VehicleOptionTypes={}));var a=function(){function t(e,t){var i=this;this.filterSliderEvent=!1,this.sortedOptions=[],this.showFilterLayoutLink=!0,this.isMobile=window.innerWidth<768,this.elementId=e,this.serverData=t,this.$element=$("#DWS_Async_Vehicle_Listing_filter_"+e),this.settings=JSON.parse($("#DWS_Async_Vehicle_Listing_Filter_Settings_"+e).html()),this.minmaxBoxTemplate=$("#DWS_Async_Vehicle_Listing_Filter_MinMaxBox_"+e).html(),this.bodyTypeSvgIconTemplate=$("#DWS_Async_Vehicle_Listing_Filter_BodyType_Svg_Icon_"+e).html(),this.makeModelSelectDropdownTemplate=$("#DWS_Async_Vehicle_Listing_Filter_MakeModel_Dropdown_"+e).html(),this.paymentTermModal=$("#DWS_Async_Vehicle_Listing_Filter_Payment_Terms_Modal_Template_"+e).html(),"layout_1"==this.settings.vehicleFilterLayout&&(this.filterItemHorizontalTemplate=$("#DWS_Async_Vehicle_Listing_Filter_Item_Horizontal_Template_"+e).html()),1==this.settings.monthlyPaymentCalculator&&$("body").append(this.paymentTermModal),window.addEventListener("resize",function(){i.isMobile=window.innerWidth<768})}return t.populateFilterOptionDetail=function(){var e={};return e[i.Year.toString()]={title:"Year",icon:"feature-year",class:"dws-filter-group-year"},e[i.Make.toString()]={title:"Make / Model",icon:"feature-make",class:"dws-filter-group-make notranslate"},e[i.Model.toString()]={title:"$vehicle_make / Model",icon:"feature-model",class:"dws-filter-group-model"},e[i.BodyType.toString()]={title:"Body Type",icon:"feature-bodytype",class:"dws-filter-group-body-type"},e[i.Price.toString()]={title:"Price Range",icon:"vehicle-price",class:"dws-filter-group-price"},e[i.Drivetrain.toString()]={title:"Drivetrain",icon:"feature-drivetrain",class:"dws-filter-group-drivetrain"},e[i.DrivetrainType.toString()]={title:"Drivetrain",icon:"feature-drivetrain",class:"dws-filter-group-drivetrain"},e[i.Transmission.toString()]={title:"Transmission",icon:"feature-transmission",class:"dws-filter-group-transmission"},e[i.Mileage.toString()]={title:"Mileage",icon:"feature-mileage",class:"dws-filter-group-mileage"},e[i.ExteriorColor.toString()]={title:"Exterior Color",icon:"feature-exterior-color",class:"dws-filter-group-exterior-color"},e[i.ExteriorColorType.toString()]={title:"Exterior Color",icon:"feature-exterior-color",class:"dws-filter-group-exterior-color"},e[i.InteriorColor.toString()]={title:"Interior Color",icon:"feature-interior-color",class:"dws-filter-group-interior-color"},e[i.InteriorColorType.toString()]={title:"Interior Color",icon:"feature-interior-color",class:"dws-filter-group-interior-color"},e[i.HighwayMPG.toString()]={title:"Highway MPG",icon:"feature-mpg",class:"dws-filter-group-highway-mpg"},e[i.CityMPG.toString()]={title:"City MPG",icon:"feature-mpg",class:"dws-filter-group-city-mpg"},e[i.VehicleClass.toString()]={title:"Vehicle Class",icon:"vehicle-class",class:"dws-filter-group-vehicle-class"},e[i.Location.toString()]={title:"Location",icon:"vehicle-location",class:"dws-filter-group-location"},e[i.Cylinder.toString()]={title:"Cylinder",icon:"feature-cylinder",class:"dws-filter-group-cylinder"},e[i.Displacement.toString()]={title:"Displacement",icon:"feature-displacement",class:"dws-filter-group-displacement"},e[i.TransmissionDetail.toString()]={title:"Transmission Detail",icon:"feature-transmission",class:"dws-filter-group-transmission-detail"},e[i.VehicleType.toString()]={title:"Vehicle Type",icon:"feature-vehicle-type",class:"dws-filter-group-vehicle-type"},e[i.VehicleLocation.toString()]={title:"Vehicle Location",icon:"vehicle-location",class:"dws-filter-group-vehicle-location"},e[i.MakeModel.toString()]={title:"Make / Model",icon:"feature-make",class:"dws-filter-group-make-model notranslate"},e[i.Image.toString()]={title:"Vehicle with images only",icon:"vehicle-image",class:"dws-filter-group-image"},e[i.FuelType.toString()]={title:"Fuel Type",icon:"feature-fueltype",class:"dws-filter-group-fuel-type"},e[i.RequiredDownAmount.toString()]={title:"Down Payment",icon:"vehicle-price",class:"dws-filter-group-required-down-amount"},e[i.TitleBrand.toString()]={title:"Title Brand",icon:"feature-title-brand",class:"dws-filter-group-title-brand"},e[i.CustomStatus.toString()]={title:"Custom Status",icon:"custom-status-2",class:"dws-filter-group-custom-status"},e[i.Equipment.toString()]={title:"Equipment",icon:"feature-equipment",class:"dws-filter-group-equipment"},e[i.Status.toString()]={title:"Inventory Status",icon:"inventory-status",class:"dws-filter-group-inventory-status"},e[i.AutoCheck.toString()]={title:"Vehicle History",icon:"vehicle-history",class:"dws-filter-group-inventory-autocheck"},e[i.CoachDesign.toString()]={title:"RV Type",icon:"feature-coach-design",class:"dws-filter-group-inventory-rv-types"},e[i.FloorPlan.toString()]={title:"Floor Plan",icon:"feature-floorplan",class:"dws-filter-group-inventory-floor-plan"},e[i.NumberOfSlideouts.toString()]={title:"Number of Slideouts",icon:"feature-slideout",class:"dws-filter-group-inventory-slideouts"},e[i.SleepingCount.toString()]={title:"Sleeping Count",icon:"feature-sleeping-count",class:"dws-filter-group-inventory-sleeping-count"},e},t.prototype.render=function(){var t=this;"layout_1"==this.settings.vehicleFilterLayout?this.renderIntoContainer($(".dws-vehicle-filter-horizontal-layout-container",this.$element)):this.renderIntoContainer($(".dws-async-vehicle-listing-filter-container",this.$element)),this.$element.hasClass("dws-horizontal-fixed-layout")?e.WebSite.Common.Utils.initializeHorizontalStickyFilter(this.$element):this.$element.closest(".dws-vertical-fixed-layout").length>0&&e.WebSite.Common.Utils.initializeVerticalStickyFilter(this.$element),this.createSliderHandle(),$(function(){t.$element[0]==$(".dws-async-vehicle-listing-filter")[0]&&$(".dws-vehicle-listing-widget").length>0?t.hookupVehicleListingButton():t.$element.removeClass("hidden-xs"),t.settings.vehicleFilterLayoutFixedOnLeft&&$(document).ready(function(){$(".dws-close-slideout-vehicle-listing-filter").click(function(){$(".dws-slideout-vehicle-listing-filter-btn").trigger("click")})})}),1!=this.settings.vehicleFilterLayoutFixedOnLeft&&1==this.settings.enableCollapsibleFilter&&($(".dws-vehicle-listing-container").before('<div class="dc-vlp-collapsible-filter"></div>'),$(".dc-vlp-collapsible-filter").append(this.$element),0==$(".dc-vlp-collapsible-filter").length&&$(".dws-slideout-vehicle-listing-filter-btn").addClass("hidden")),null!==document.querySelector(".dws-slideout-vehicle-listing-filter-btn")&&null!==document.querySelector(".dc-vlp-collapsible-filter")&&1==this.settings.enableCollapsibleFilter&&document.querySelector(".dws-slideout-vehicle-listing-filter-btn").addEventListener("click",function(e){$(".dc-vlp-collapsible-filter").stop().slideToggle("fast")})},t.prototype.renderIntoContainer=function(e,a){var r=this;void 0===a&&(a=!1);var n=this.settings.selectedFilters.split(","),l=_.groupBy(this.serverData,function(e){return e.OptionType.toString()});this.filterOptionsWithRange=[],this.sortedOptions=[],n=this.getSelectedFilterWithValidData(n,l),this.manageMakeAndModelSorting(n),this.manageYearFilterSorting(n),this.manageFilterOptionsUsingCheckbox(n),this.manageFilterOptionsUsingSlider(n),this.manageTitleBrandFilterSorting(n),this.manageCustomStatusFilterSorting(n),this.manageStatusFilterSorting(n),this.manageAutoCheckFilterSorting(n),_.chain(this.sortedOptions).keys().each(function(l){var o=r.settings.filterSettings["_"+n[l]],s=r.processFilterOptionsToShow(o),d=t.filterOptions[parseInt(n[l])].icon,p=r.processFilterOptionTitle(n,l),c=r.showFilterLayoutLink,u=t.filterOptions[parseInt(n[l])].class,m=$("<li></li>").addClass("list-group-item dws-async-vehicle-listing-filter-option-title").append($("<strong></strong>").text(p)),h=_.invert(i)[parseInt(n[l])];if("vehicle-image"==d)var g="dws-media-icons-images";else g="dws-icons-"+d;if(r.settings.showFieldsIcon&&m.prepend($('<span class="dws-vehicle-listing-item-icon '+g+'"></span>')),0==a&&"layout_1"==r.settings.vehicleFilterLayout){var y="";r.settings.showFieldsIcon&&(y='<span class="dws-vehicle-listing-item-icon '+g+'"></span>'),v=r.createHorizontalListContainer(h,p,e,y,u)}else{var f=$("<div></div>").addClass("dws-async-vehicle-listing-filter-option-container "+u+" clearfix").appendTo(e),v=$("<ul></ul>").addClass("list-group").appendTo(f);r.listItemClass="list-group-item",v.append(m)}"object"==typeof r.settings.filterFieldLayouts[h]&&"string"==typeof r.settings.filterFieldLayouts[h].layout&&"minmaxbox"==r.settings.filterFieldLayouts[h].layout.toString()&&(r.settings.filterFieldLayouts[h].show_link=r.showFilterLayoutLink,v=r.createMinMaxContainer(v,h),c=r.settings.filterFieldLayouts[h].show_link);var w=r.sortedOptions[l][0];if(w.usingSliderOption)v=r.createFilterSliderOptionsContainer(v,w,a);else if(c){var C=r.createOptionValueElements(r.sortedOptions[l],p);"object"==typeof r.settings.filterFieldLayouts[h]&&"string"==typeof r.settings.filterFieldLayouts[h].layout&&"color_palette"==r.settings.filterFieldLayouts[h].layout.toString()&&(C=r.createGroupPrimaryColorsPaletteMarkup(r.sortedOptions[l],p));var S=C,b=null;if(r.settings.collapsibleFilterOptions&&"layout_1"!=r.settings.vehicleFilterLayout||r.settings.collapsibleFilterOptions&&"layout_1"==r.settings.vehicleFilterLayout&&a){e.addClass("collapsible-filter-options-container");var x=$("<ul></ul>").addClass("collapsible-filer-options-container").append(S).hide();v.append(x),r.createCollapsibleFilter(m,x,r.settings.collapsibleFilterOptionsTickIcon)}else s>0&&C.length>s&&(S=C.splice(0,s),b=C,v.addClass("dws-async-vehicle-listing-filter-has-more"),"object"==typeof r.settings.filterFieldLayouts[h]&&"string"==typeof r.settings.filterFieldLayouts[h].layout&&"color_palette"==r.settings.filterFieldLayouts[h].layout.toString()&&v.addClass("dws-palette-color-list-has-more")),v.append(S);if(null!==b){var F=$("<ul></ul>").addClass("list-group dws-async-vehicle-listing-filter-more-group").appendTo(f).hide();"object"==typeof r.settings.filterFieldLayouts[h]&&"string"==typeof r.settings.filterFieldLayouts[h].layout&&"color_palette"==r.settings.filterFieldLayouts[h].layout.toString()&&(F.addClass("dws-palette-color-list-more-group"),f.append("<div></div>")),F.append(b);var T=$("<a href='javascript:void(0);'></a>").addClass("toggle-view-more").click(function(e){var t=$(e.target);F.is(":visible")?("object"==typeof r.settings.filterFieldLayouts[h]&&"string"==typeof r.settings.filterFieldLayouts[h].layout&&"color_palette"==r.settings.filterFieldLayouts[h].layout.toString()?F.css("display","none"):F.slideUp(),t.html("View More..").attr("aria-label","view more "+p+" filters")):("object"==typeof r.settings.filterFieldLayouts[h]&&"string"==typeof r.settings.filterFieldLayouts[h].layout&&"color_palette"==r.settings.filterFieldLayouts[h].layout.toString()?F.css("display","inline"):F.slideDown(),t.html("View Less..").attr("aria-label","view less "+p+" filters"))}).html("View More..").attr("aria-label","view more "+p+" filters");f.append(T)}}}),0==a&&"layout_1"==this.settings.vehicleFilterLayout?this.hookResetButtonEventsForHorizontalLayout(e):this.hookResetButtonEventsForDefaultLayout(e),this.createApplyFiltersButton(a,e)},t.prototype.processFilterOptionTitle=function(e,a){var r=t.filterOptions[parseInt(e[a])].title;return r=r.replace("$vehicle_make",this.settings.currentMake),i.Make==parseInt(e[a])&&this.settings.useCheckboxesForSelectedFilterOptions.make.Value&&(r="Make"),i.Model==parseInt(e[a])&&this.settings.useCheckboxesForSelectedFilterOptions.model.Value&&(r="Model"),r},t.prototype.processFilterOptionsToShow=function(e){var i=t.maxItemToShow;return e&&e.cnt&&("all"==e.cnt?i=-1:(i=parseInt(e.cnt),isNaN(i)&&(i=t.maxItemToShow))),i},t.prototype.hookResetButtonEventsForHorizontalLayout=function(e){var t=this;$(".dws-vehicle-filter-button-reset-filters",e).click(function(){if("NHT-V2"==t.settings.customTheme)document.location.href=document.location.pathname;else{t.settings.isFrontPage&&(document.location.href=document.location.pathname);var e=t.settings.hasParentPage?t.settings.hasParentPage:document.location.pathname.match(/^\/[^/]*/)[0]+"/";document.location.href=e}})},t.prototype.hookResetButtonEventsForDefaultLayout=function(e){var t=this;e.append($("<button></button>").addClass("vehicle-filter-reset-button btn btn-block "+this.settings.resetButtonClass+this.settings.resetFiltersButtonDisplay).html("RESET FILTERS").click(function(){if("NHT-V2"==t.settings.customTheme)document.location.href=document.location.pathname;else{t.settings.isFrontPage&&(document.location.href=document.location.pathname);var e=t.settings.hasParentPage?t.settings.hasParentPage:document.location.pathname.match(/^\/[^/]*/)[0]+"/";document.location.href=e}}))},t.prototype.createApplyFiltersButton=function(e,t){var a=this,r={},n=this.settings.monthlyPaymentCalculator,l=this.elementId;if(e)var o="#DWS_Async_Vehicle_Listing_Filter_Modal_"+this.elementId;else o="#DWS_Async_Vehicle_Listing_filter_"+this.elementId;var s=$("<button></button>").addClass("vehicle-filter-apply-button btn "+this.settings.applyFiltersButtonClass).html("APPLY FILTERS").click(function(){var t=a.getCurrentPathAndcurrentQuery(),s=t.currentPath,d=t.currentQuery,p="";for(var c in $(o+" .dws-filter-layout-slider-enabled").each(function(){var t=$(this).find(".dws-filter-slider-input"),a=$(t).data("filter-option-type"),s=$(t).data("slider-min"),d=$(t).data("slider-max"),p=$(t).val().split(","),c=p[0],u=p[1];switch(parseInt(a)){case i.Year:if(r.vehicle_year||(r.vehicle_year=[]),s==c&&d==u)delete r.vehicle_year;else for(var m=c;m<=u;m++)r.vehicle_year.push(m);break;case i.Price:var h=$(o+" .dws-filter-layout-slider-enabled").find(".dws-monthly-payment-calculator-price-min"),g=$(o+" .dws-filter-layout-slider-enabled").find(".dws-monthly-payment-calculator-price-max");if((s<c||d>u)&&(r.price_min=0!==h.length?h.text().replace(/,/g,"").replace("$",""):c,r.price_max=0!==g.length?g.text().replace(/,/g,"").replace("$",""):u),1==n){var y="#DWS_Async_Vehicle_Listing_filter_"+l;e&&(y="#DWS_Async_Vehicle_Listing_Filter_Modal_"+l);var f=$(y+" .dws-monthly-payment-calculator-wrapper");$(y+" .dws-monthly-payment-calculator-enabled .list-group-item .slider-horizontal");if(f.length>0){var v=f.find(".dws-monthly-payment-calculator-payment-min-field"),w=f.find(".dws-monthly-payment-calculator-payment-max-field");(s<c||d>u)&&(r.monthly_payment_min=v.text().replace(/,/g,"").replace("$",""),r.monthly_payment_max=w.text().replace(/,/g,"").replace("$",""));var C="#DWS_Async_Vehicle_Listing_Filter_Payment_Terms_Modal_"+l,S=$(C+" .dws-payment-term-form-btn");S.click(function(){var e=$(y+" .dws-term-monthly").text(),t=$(y+" .dws-term-apr").text(),i=$(y+" .dws-term-down").text().replace(/,/g,"").replace("$","");r.apr=t,r.down=i,r.term=e})}}break;case i.Mileage:(s<c||d>u)&&(r.mileage_min=c,r.mileage_max=u)}}),$('.dws-async-vehicle-listing-filter-option-container input[type="checkbox"]:checked, .dws-filter-option-checkbox:checked ').each(function(){var e=$(this),t=e.data("url-parameter"),i=e.val().toLowerCase();r[t]||(r[t]=[]),r[t].push(i)}),r)r.hasOwnProperty(c)&&(Array.isArray(r[c])&&r[c].length>1?p+=c+"="+encodeURIComponent(r[c].join(","))+"&":p+=c+"="+encodeURIComponent(r[c])+"&");if(p&&p.length>0&&(p=p.slice(0,-1)),null!=d&&(d.includes("mileage_min")||d.includes("mileage_max")||d.includes("price_min")||d.includes("price_max")||d.includes("monthly_payment_min")||d.includes("monthly_payment_max")||d.includes("apr")||d.includes("down")||d.includes("term")))for(var u=d.split("&"),m=0;m<u.length;m++)(u[m].includes("mileage_min")||u[m].includes("mileage_max")||u[m].includes("price_min")||u[m].includes("price_max")||u[m].includes("monthly_payment_min")||u[m].includes("monthly_payment_max")||u[m].includes("apr")||u[m].includes("down")||u[m].includes("term"))&&(p+="&"+u[m]);""!=p&&(document.location.href=s+(null==p?"":"?"+p))});t.append(s)},t.prototype.createFilterSliderOptionsContainer=function(e,t,a){var r=this;e.addClass("dws-filter-layout-slider-enabled");var n=$("<li></li>").addClass(this.listItemClass),l=$("<input>").attr("type","text");l.attr("data-provide","slider"),l.attr("data-slider-min",t.minValue),l.attr("data-slider-max",t.maxValue),l.attr("data-slider-step",t.Interval),l.attr("data-filter-option-type",t.optionType),l.attr("data-slider-tooltip","hide");var o=t.minValue,s=t.maxValue;switch(t.optionType){case i.Year:if(0!=this.settings.selectedYear.length){var d=this.settings.selectedYear,p=d.split(",");l.attr("data-slider-value","["+p[0]+","+p[p.length-1]+"]"),o=p[0],s=p[p.length-1]}else l.attr("data-slider-value","["+t.minValue+","+t.maxValue+"]"),o=t.minValue,s=t.maxValue;l.attr("aria-label","Vehicle Year Filter");break;case i.Price:if(1==this.settings.monthlyPaymentCalculator&&(t.maxValue="2000",t.Interval=50,l.attr("data-slider-max",t.maxValue),l.attr("data-slider-step",t.Interval),s=t.maxValue),l.attr("data-slider-value","["+t.minValue+","+t.maxValue+"]"),o=t.minValue,s=t.maxValue,0!=this.settings.selectedPrice.length){l.attr("data-slider-value","["+this.settings.selectedPrice+"]");var c=this.settings.selectedPrice.split(",");c.length>0&&""!==c[0].trim()&&(o=c[0].trim()),c.length>1&&""!==c[1].trim()&&(s=c[1].trim())}if(l.attr("aria-label","Vehicle Price Filter"),1==this.settings.monthlyPaymentCalculator&&""!=this.settings.selectedMonthlyPayment&&0!=this.settings.selectedPrice.length){l.attr("data-slider-value","["+this.settings.selectedMonthlyPayment+"]");c=this.settings.selectedMonthlyPayment.split(",");c.length>0&&""!==c[0].trim()&&(o=c[0].trim()),c.length>1&&""!==c[1].trim()&&(s=c[1].trim())}break;case i.Mileage:if(l.attr("data-slider-value","["+t.minValue+","+t.maxValue+"]"),o=t.minValue,s=t.maxValue,0!=this.settings.selectedMileage.length){l.attr("data-slider-value","["+this.settings.selectedMileage+"]");var u=this.settings.selectedMileage.split(",");u.length>0&&""!==u[0].trim()&&(o=u[0].trim()),u.length>1&&""!==u[1].trim()&&(s=u[1].trim())}l.attr("aria-label","Vehicle Mileage Filter");break;case i.CityMPG:if(l.attr("data-slider-value","["+t.minValue+","+t.maxValue+"]"),o=t.minValue,s=t.maxValue,0!=this.settings.selectedCityMpg.length){l.attr("data-slider-value","["+this.settings.selectedCityMpg+"]");var m=this.settings.selectedCityMpg.split(",");m.length>0&&""!==m[0].trim()&&(o=m[0].trim()),m.length>1&&""!==m[1].trim()&&(s=m[1].trim())}l.attr("aria-label","Vehicle City MPG Filter");break;case i.HighwayMPG:if(l.attr("data-slider-value","["+t.minValue+","+t.maxValue+"]"),o=t.minValue,s=t.maxValue,0!=this.settings.selectedHighwayMpg.length){l.attr("data-slider-value","["+this.settings.selectedHighwayMpg+"]");var h=this.settings.selectedHighwayMpg.split(",");h.length>0&&""!==h[0].trim()&&(o=h[0].trim()),h.length>1&&""!==h[1].trim()&&(s=h[1].trim())}l.attr("aria-label","Vehicle Highway MPG Filter");break;case i.RequiredDownAmount:if(t.Interval=5e3,l.attr("data-slider-step",t.Interval),l.attr("data-slider-value","["+t.minValue+","+t.maxValue+"]"),o=t.minValue,s=t.maxValue,0!=this.settings.selectedMonthlyPayment.length){l.attr("data-slider-value","["+this.settings.selectedMonthlyPayment+"]");var g=this.settings.selectedMonthlyPayment.split(",");g.length>0&&""!==g[0].trim()&&(o=g[0].trim()),g.length>1&&""!==g[1].trim()&&(s=g[1].trim())}l.attr("aria-label","Vehicle Required Down Filter")}if(t.disableSliderOption&&l.attr("data-slider-enabled","false"),a)var y="emodal-sliderhandler-filter-key-"+t.key;else y="filter-key-"+t.key;l.attr("id",y),l.attr("class","dws-filter-slider-input");var f=this.changeUpdateButtonLayout(t,y),v=document.createElement("div");v.className="dws-vehicle-filter-slider-wrapper",v.setAttribute("role","presentation");var w=document.createElement("span");w.className="dws-vehicle-filter-slider-value-min",w.innerHTML=this.formatFilterLabels(t.optionType,o),v.append(w);var C=document.createElement("span");if(C.className="dws-vehicle-filter-slider-value-max",C.innerHTML=this.formatFilterLabels(t.optionType,s),v.append(C),n.append(v),n.append(l.hide()).append(f.hide()),1==this.settings.monthlyPaymentCalculator&&t.optionType==i.Price){var S="#DWS_Async_Vehicle_Listing_filter_"+this.elementId;a&&(S="#DWS_Async_Vehicle_Listing_Filter_Modal_"+this.elementId);var _=this.renderMonthlyPaymentCalculatorLabels(t),b=this.renderMonthlyPaymentCalculatorPaymentTerms();if(""!=this.settings.selectedMonthlyPayment){var x=this.settings.selectedMonthlyPayment.split(",");t.minValue=x[0],t.maxValue=x[1],_=this.renderMonthlyPaymentCalculatorLabels(t,!0),b=this.renderMonthlyPaymentCalculatorPaymentTerms(!0);var F="#DWS_Async_Vehicle_Listing_Filter_Payment_Terms_Modal_"+this.elementId,T=this.settings.selectedMonthlyPaymentTerm;T.apr="1.9"==T.apr?"1.99":T.apr;var O={apr:""==T.apr?1.9:+T.apr,term:""==T.term?72:+T.term,cashDown:""==T.cashDown?0:+T.cashDown};$(F+" .dws-payment-cash-down-field").val(+O.cashDown),$(F+" .dws-payment-terms-field").val(+O.term),$(F+" .dws-payment-tier-field").val(+O.apr)}n.prepend(_),n.append(b),e.addClass("dws-monthly-payment-calculator-enabled"),l.attr("data-slider-tooltip","hide");var k="#DWS_Async_Vehicle_Listing_Filter_Payment_Terms_Modal_"+this.elementId,V=$(k+" .dws-payment-term-form-btn");V.click(function(){r.updatePaymentTermsFields(a);var e=r.getCurrentPathAndcurrentQuery(),t=e.currentPath,i=e.currentQuery;null!=i?i+="&":i="";var n=t+(null==i?"":"?"+i),l="",o=n;$(S+" .btn-update-price").hasClass("btn-update-price")&&(o=r.updateMonthlyPaymentButtonHref(n,o,l,S)),$(S+" .btn-update-price").attr("href",o)}),$(k).on("show.bs.modal",function(e){V.click(function(){$(k).modal("hide")})}),$(k).on("hidden.bs.modal",function(e){$(".dws-async-vehicle-listing-filter-container").closest(".modal").css({"overflow-y":"auto"})})}return e.append(n)},t.prototype.renderMonthlyPaymentCalculatorLabels=function(t,i){var a;void 0===i&&(i=!1);var r="",n="",l="",o="",s={apr:1.9,term:72,cashDown:0};if(1==i){var d=this.settings.selectedMonthlyPaymentTerm;s={apr:""==d.apr?1.9:+d.apr,term:""==d.term?72:+d.term,cashDown:""==d.cashDown?0:+d.cashDown}}var p=this.calculateMonthlyPaymentPrice(s,t.minValue),c=this.calculateMonthlyPaymentPrice(s,t.maxValue),u=p.replace(/\$|,/g,""),m=c.replace(/\$|,/g,"");p=+u<=0?0:p,c=+m<=0?0:c,1==i&&0!=this.settings.selectedPrice.length&&(r="$"+e.WebSite.Common.Utils.formatWithSeparator(t.minValue),n="$"+e.WebSite.Common.Utils.formatWithSeparator(t.maxValue),l="$"+p,o="$"+c),a=$("<div></div>").addClass("dws-monthly-payment-calculator-wrapper");var h=$("<div></div>").addClass("dws-monthly-payment-calculator-price-container");a.append(h);var g=$("<div></div>").addClass("dws-monthly-payment-calculator-price-label").append("Price:"),y=$("<div></div>").addClass("dws-monthly-payment-calculator-price-min").append(l),f=$("<div></div>").addClass("dws-monthly-payment-calculator-price-max").append(o);h.append(g).append(y).append(f);var v=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-container");a.append(v);var w=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-label").append("Payment:"),C=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-min").append('<span class="dws-monthly-payment-calculator-payment-min-field">'+r+"</span>"),S=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-max").append('<span class="dws-monthly-payment-calculator-payment-max-field">'+n+"</span>");v.append(w).append(C).append(S);var _=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-container dws-min-max-label");a.append(_);var b=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-label"),x=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-min").append("<span>min</span>"),F=$("<div></div>").addClass("dws-monthly-payment-calculator-payment-max").append("<span>max</span>");return _.append(b).append(x).append(F),a},t.prototype.renderMonthlyPaymentCalculatorPaymentTerms=function(t){var i;void 0===t&&(t=!1);var a=1.9,r=72,n=0;if(1==t){var l=this.settings.selectedMonthlyPaymentTerm;a=""==l.apr?1.9:+l.apr,r=""==l.term?72:+l.term,n=""==l.cashDown?0:+l.cashDown}i=$("<div></div>").addClass("dws-monthly-payment-calculator-term-wrapper");var o=$("<div></div>").addClass("dws-monthly-payment-calculator-term-label-container");i.append(o);var s=$("<div></div>").addClass("dws-term-monthly-container").append('<span class="dws-term-monthly">'+r+"</span> mo."),d=$("<div></div>").addClass("dws-term-apr-container").append('@ <span class="dws-term-apr">'+a+"</span>%,"),p=$("<div></div>").addClass("dws-term-down-container").append('$<span class="dws-term-down">'+e.WebSite.Common.Utils.formatWithSeparator(n.toString())+"</span> down");o.append(s).append(d).append(p);var c=$("<div></div>").addClass("dws-monthly-payment-calculator-edit-term-container");i.append(c);var u=$("<a></a>").addClass("dws-monthly-payment-edit-term").attr("data-target","#DWS_Async_Vehicle_Listing_Filter_Payment_Terms_Modal_"+this.elementId).attr("data-toggle","modal").attr("data-backdrop","static").append("Edit Payment Terms");return c.append(u),i},t.prototype.calculateMonthlyPaymentPrice=function(t,i){var a=t.apr?t.apr:1.9,r=t.term?t.term:72,n=t.cashDown?t.cashDown:0,l=i?+i:0,o=a/12/100,s=o+o/(Math.pow(o+1,r)-1),d=Math.round(l/s),p=d-n,c=this.roundNearestThousand(p),u=e.WebSite.Common.Utils.formatWithSeparator(c.toString());return u},t.prototype.updatePaymentTermsFields=function(t){void 0===t&&(t=!1);var i="#DWS_Async_Vehicle_Listing_Filter_Payment_Terms_Modal_"+this.elementId,a="#DWS_Async_Vehicle_Listing_filter_"+this.elementId;t&&(a="#DWS_Async_Vehicle_Listing_Filter_Modal_"+this.elementId);var r=$(i+" .dws-payment-tier-field"),n=$(i+" .dws-payment-terms-field"),l=$(i+" .dws-payment-cash-down-field"),o=r.val()?r.val():1.9,s=n.val()?n.val():72,d=!isNaN(l.val())&&l.val()>0?+l.val():0,p=e.WebSite.Common.Utils.formatWithSeparator(d.toString()),c=$(a+" .dws-term-apr"),u=$(a+" .dws-term-monthly"),m=$(a+" .dws-term-down");c.text(o),u.text(s),m.text(p),this.updateMonthlyPaymentPrice(t)},t.prototype.updateMonthlyPaymentPrice=function(e){void 0===e&&(e=!1);var t="#DWS_Async_Vehicle_Listing_filter_"+this.elementId;e&&(t="#DWS_Async_Vehicle_Listing_Filter_Modal_"+this.elementId);var i=$(t+" .dws-term-apr"),a=$(t+" .dws-term-monthly"),r=$(t+" .dws-term-down"),n={apr:+i.text(),term:+a.text(),cashDown:+r.text().replace(/\$|,/g,"")},l=$(t+" .dws-monthly-payment-calculator-payment-min-field"),o=$(t+" .dws-monthly-payment-calculator-payment-max-field");""==l.text()&&""==o.text()&&(l.text("$0"),o.text("$2,000"));var s=l.text().replace(/\$|,/g,""),d=o.text().replace(/\$|,/g,""),p=this.calculateMonthlyPaymentPrice(n,+s),c=this.calculateMonthlyPaymentPrice(n,+d),u=$(t+" .dws-monthly-payment-calculator-price-min"),m=$(t+" .dws-monthly-payment-calculator-price-max");p=parseInt(p.replace(/\$|,/g,""))<=0?"0":p,c=parseInt(c.replace(/\$|,/g,""))<=0?"0":c,u.text("$"+p),m.text("$"+c)},t.prototype.changeUpdateButtonLayout=function(e,t){var a;if("style_1"==this.settings.vehicleFilterStyle)switch(e.optionType){case i.Year:a=$("<a></a>").attr("id",t+"-button").attr("rel","nofollow").addClass("btn-update-widget-layout-1 btn-update-year btn-update-vehicle-filter").html("UPDATE");break;case i.Price:a=$("<a></a>").attr("id",t+"-button").attr("rel","nofollow").addClass("btn-update-widget-layout-1 btn-update-price btn-update-vehicle-filter").html("UPDATE");break;case i.Mileage:a=$("<a></a>").attr("id",t+"-button").attr("rel","nofollow").addClass("btn-update-widget-layout-1 btn-update-mileage btn-update-vehicle-filter").html("UPDATE");break;case i.CityMPG:a=$("<a></a>").attr("id",t+"-button").attr("rel","nofollow").addClass("btn-update-widget-layout-1 btn-update-city-mpg btn-update-vehicle-filter").html("UPDATE");break;case i.HighwayMPG:a=$("<a></a>").attr("id",t+"-button").attr("rel","nofollow").addClass("btn-update-widget-layout-1 btn-update-highway-mpg btn-update-vehicle-filter").html("UPDATE");break;case i.RequiredDownAmount:a=$("<a></a>").attr("id",t+"-button").attr("rel","nofollow").addClass("btn-update-widget-layout-1 btn-update-required-down btn-update-vehicle-filter").html("UPDATE")}else switch(e.optionType){case i.Year:a=$("<a></a>").attr("type","button").attr("id",t+"-button").attr("rel","nofollow").addClass("btn btn-update-year btn-block btn-update-vehicle-filter "+this.settings.resetButtonClass).html("UPDATE");break;case i.Price:a=$("<a></a>").attr("type","button").attr("id",t+"-button").attr("rel","nofollow").addClass("btn btn-update-price btn-block btn-update-vehicle-filter "+this.settings.resetButtonClass).html("UPDATE");break;case i.Mileage:a=$("<a></a>").attr("type","button").attr("id",t+"-button").attr("rel","nofollow").addClass("btn btn-update-mileage btn-block btn-update-vehicle-filter "+this.settings.resetButtonClass).html("UPDATE");break;case i.CityMPG:a=$("<a></a>").attr("type","button").attr("id",t+"-button").attr("rel","nofollow").addClass("btn btn-update-city-mpg btn-block btn-update-vehicle-filter "+this.settings.resetButtonClass).html("UPDATE");break;case i.HighwayMPG:a=$("<a></a>").attr("type","button").attr("id",t+"-button").attr("rel","nofollow").addClass("btn btn-update-highway-mpg btn-block btn-update-vehicle-filter "+this.settings.resetButtonClass).html("UPDATE");break;case i.RequiredDownAmount:a=$("<a></a>").attr("type","button").attr("id",t+"-button").attr("rel","nofollow").addClass("btn btn-update-required-down btn-block btn-update-vehicle-filter "+this.settings.resetButtonClass).html("UPDATE")}return a},t.prototype.createMinMaxContainer=function(t,i){t.addClass("dws-filter-layout-minmaxbox-enabled");var a=$("<li></li>").addClass(this.listItemClass+" dws-filter-layout").append($(this.minmaxBoxTemplate));$(".dws-filter-layout-minmaxbox-container",a).addClass("dws-filter-fields dws-filter-field-"+i.toLowerCase()),$(".dws-filter-layout-minmaxbox-container",a).attr("data-param-min",this.settings.filterFieldLayouts[i].min),$(".dws-filter-layout-minmaxbox-container",a).attr("data-param-max",this.settings.filterFieldLayouts[i].max),""!==this.settings.filterFieldLayouts[i].list&&$(".dws-filter-layout-minmaxbox-container",a).attr("data-param-list",this.settings.filterFieldLayouts[i].list),""!==this.settings.filterFieldLayouts[i].valid_min&&$(".dws-filter-layout-minmaxbox-container",a).attr("data-param-valid-min",this.settings.filterFieldLayouts[i].valid_min),$(".dws-filter-update a",a).on("click",function(t){var i=$(this).parents(".dws-filter-layout-minmaxbox-container"),a=i.data("param-min"),r=i.data("param-max"),n=i.data("param-list"),l=i.data("param-valid-min"),o=$(".dws-filter-min-input input",i).val(),s=$(".dws-filter-max-input input",i).val(),d="",p=e.WebSite.Common.Utils.parse_url(),c=p.fullPath,u=p.query;if(""!=o){
if(isNaN(parseInt(o)))return $(".dws-filter-min-input input",i).addClass("error"),o="",!1;$(".dws-filter-min-input input",i).removeClass("error"),o=parseInt(o)}if(""!=s){if(isNaN(parseInt(s)))return $(".dws-filter-max-input input",i).addClass("error"),s="",!1;$(".dws-filter-max-input input",i).removeClass("error"),s=parseInt(s)}var m=u;if(void 0!==n){var h,g=1;for(o=""==o?s:parseInt(o)<parseInt(l)?l:o,s=""==s?o:s,h=parseInt(o);h<=parseInt(s);h+=g)d+=d.length>0?",":"",d+=h.toString();if(m.indexOf(n)>=0){var y=new RegExp("("+n+"=)[^&]+");m=m.replace(y,"$1"+d.toString())}else m+=m.length>0?"&":"",m+=n+"="+d}else{if(""!=o)if(m.indexOf(a)>=0){y=new RegExp("("+a+"=)[^&]+");m=m.replace(y,"$1"+o.toString())}else m+=m.length>0?"&":"",m+=a+"="+o;else if(m.indexOf(a)>=0){y=new RegExp("("+a+")[^&]+");m=m.replace(y,"")}if(""!=s)if(m.indexOf(r)>=0){y=new RegExp("("+r+"=)[^&]+");m=m.replace(y,"$1"+s.toString())}else m+=m.length>0?"&":"",m+=r+"="+s;else if(m.indexOf(r)>=0){y=new RegExp("("+r+")[^&]+");m=m.replace(y,"")}}var f=c;return m.length>0&&(0==m.indexOf("&")&&(m=m.substr(1,m.length-1)),f=c+"?"+m),$(this).attr("href",f),parseInt(o)>parseInt(s)?($(".dws-filter-input input",i).addClass("error"),!1):($(".dws-filter-input input",i).removeClass("error"),!0)});var r=e.WebSite.Common.Utils.parse_url(),n=r.query;return(""!==this.settings.filterFieldLayouts[i].min&&n.indexOf(this.settings.filterFieldLayouts[i].min)>=0||""!==this.settings.filterFieldLayouts[i].max&&n.indexOf(this.settings.filterFieldLayouts[i].max)>=0||""!==this.settings.filterFieldLayouts[i].list&&n.indexOf(this.settings.filterFieldLayouts[i].list)>=0)&&(this.settings.filterFieldLayouts[i].show_link=!1),t.append(a)},t.prototype.createHorizontalListContainer=function(e,t,i,a,r){var n=this,l=$(".dws-vehicle-filter-groups",i),o=$(this.filterItemHorizontalTemplate).appendTo(l),s="";"object"==typeof this.settings.filterFieldLayouts[e]&&"string"==typeof this.settings.filterFieldLayouts[e].layout&&"slider"==this.settings.filterFieldLayouts[e].layout.toString()&&(o.on("hide.bs.dropdown",function(e){if(n.filterSliderEvent)return n.filterSliderEvent=!1,!1}),s="remove-overflow-hidden"),o.addClass(r);var d=$(".dws-vehicle-filter-list",o).addClass(s),p=$(".dws-vehicle-filter-group-header",o),c=p.html().replace("{{Dummy Group Title}}",t);return $(".dws-vehicle-filter-group-header",o).html(c),this.listItemClass="dws-vehicle-filter-list-item",null!==a&&p.prepend(a+"&nbsp;"),d},t.prototype.getSelectedFilterWithValidData=function(e,t){var i=this;return e=_.select(e,function(e){return"99"==e||void 0!==t[e]}),_.each(e,function(e){if("99"==e)void 0!==t[e]?i.sortedOptions.push(t[e]):i.sortedOptions.push([{OptionType:99,Count:1,Value:"images-only",Value2:"Vehicle with images only"}]);else if("18"==e){if(void 0!==t[e]){if(""!=i.settings.customStatusToDisplay){var a=i.settings.customStatusToDisplay.split(",").map(function(e){return e.trim().toLowerCase()}).filter(Boolean);if(a.length>0){var r=t[e].filter(function(e){return a.includes(e.Value.toLowerCase())});r.length>0&&(t[e]=r)}}i.sortedOptions.push(t[e])}}else void 0!==t[e]&&i.sortedOptions.push(t[e])}),e},t.prototype.manageMakeAndModelSorting=function(e){var t=this,a=e.indexOf(i.Make.toString()),r=e.indexOf(i.Model.toString()),n=e.indexOf(i.MakeModel.toString());n>=0&&this.sortedOptions[n].sort(function(e,t){return e.Value>t.Value?1:t.Value>e.Value?-1:0}),this.settings.sortMakeModelByVehicleCount&&(a>=0&&this.sortedOptions[a].sort(function(e,t){return t.Count-e.Count}),r>=0&&this.sortedOptions[r].sort(function(e,t){return t.Count-e.Count}),n>=0&&this.sortedOptions[n].sort(function(e,t){return t.Count-e.Count}));var l=this.settings.vehicleMakeSorting.split(",");if(a>=0||n>=0){var o=0;a=n>=0?n:a;var s=_.map(this.sortedOptions[a],function(e){return e.Value});_.each(l,function(e){if(_.contains(s,e)){var i=_.map(t.sortedOptions[a],function(e){return e.Value}).indexOf(e),r=i,n=o,l=t.sortedOptions[a][r];t.sortedOptions[a].splice(r,1),t.sortedOptions[a].splice(n,0,l),o++}})}},t.prototype.manageYearFilterSorting=function(e){var t=e.indexOf(i.Year.toString());t>=0&&this.sortedOptions[t].sort(function(e,t){return t.Value-e.Value})},t.prototype.manageTitleBrandFilterSorting=function(e){var t=e.indexOf(i.TitleBrand.toString());t>=0&&this.sortedOptions[t].sort(function(e,t){return e.Value>t.Value?1:t.Value>e.Value?-1:0})},t.prototype.manageCustomStatusFilterSorting=function(e){var t=e.indexOf(i.CustomStatus.toString());t>=0&&this.sortedOptions[t].sort(function(e,t){return e.Value>t.Value?1:t.Value>e.Value?-1:0})},t.prototype.manageStatusFilterSorting=function(e){var t=e.indexOf(i.Status.toString());t>=0&&this.sortedOptions[t].sort(function(e,t){return e.Value>t.Value?1:t.Value>e.Value?-1:0})},t.prototype.manageAutoCheckFilterSorting=function(e){var t=e.indexOf(i.AutoCheck.toString());t>=0&&this.sortedOptions[t].sort(function(e,t){return e.Value>t.Value?1:t.Value>e.Value?-1:0})},t.prototype.manageFilterOptionsUsingCheckbox=function(e){var t=this;if(this.settings.useCheckboxesForSelectedFilterOptions&&this.settings.vehicleFilterGetParameters){var a,r,n,l=function(l){if(void 0!==o.settings.useCheckboxesForSelectedFilterOptions[l]&&o.settings.useCheckboxesForSelectedFilterOptions[l].Value){var s=e.indexOf(o.settings.useCheckboxesForSelectedFilterOptions[l].OptionType.toString());if(s>=0){var d=o.settings.vehicleFilterGetParameters[l];if(o.settings.useCheckboxesForSelectedFilterOptions[l].OptionType==i.VehicleClass&&(d=d.replace("new","1").replace("used","2").replace("certified","3")),o.settings.useCheckboxesForSelectedFilterOptions[l].OptionType==i.VehicleType){var p={auto:"1",motorcycle:"2",atv:"3",watercraft:"4",snowmobile:"5",rv:"6",classiExotic:"7",other:"99"};d=d.replace(/auto|motorcycle|atv|watercraft|snowmobile|rv|classiExotic|other/g,function(e){return p[e]})}o.settings.useCheckboxesForSelectedFilterOptions[l].OptionType==i.TransmissionDetail?a=d.split("|"):(a=d.split(","),a=a.map(function(e){return e.replace(/\\/g,"")})),a.sort(function(e,t){return t-e}),r=0,n=_.map(o.sortedOptions[s],function(e){return e.Value}),_.each(a,function(e){if("images-only"!=e)e=e.toUpperCase();_.contains(n,e)||t.sortedOptions[s].push({Count:0,OptionType:t.sortedOptions[s][0].OptionType,Value:e});var i=_.map(t.sortedOptions[s],function(e){return e.Value}).indexOf(e),a=i,l=r,o=t.sortedOptions[s][a];t.sortedOptions[s].splice(a,1),t.sortedOptions[s].splice(l,0,o),r++})}}},o=this;for(var s in this.settings.vehicleFilterGetParameters)l(s)}},t.prototype.manageFilterOptionsUsingSlider=function(e){var t=this;if(("slider"==this.settings.filterFieldLayouts.Year.layout.toString()||"slider"==this.settings.filterFieldLayouts.Price.layout.toString()||"slider"==this.settings.filterFieldLayouts.Mileage.layout.toString()||"slider"==this.settings.filterFieldLayouts.RequiredDownAmount.layout.toString()||"slider"==this.settings.filterFieldLayouts.CityMPG.layout.toString()||"slider"==this.settings.filterFieldLayouts.HighwayMPG.layout.toString())&&("slider"==this.settings.filterFieldLayouts.Year.layout.toString()&&e.indexOf(i.Year.toString())>=0&&this.filterOptionsWithRange.push(e.indexOf(i.Year.toString())),"slider"==this.settings.filterFieldLayouts.Price.layout.toString()&&e.indexOf(i.Price.toString())>=0&&this.filterOptionsWithRange.push(e.indexOf(i.Price.toString())),"slider"==this.settings.filterFieldLayouts.Mileage.layout.toString()&&e.indexOf(i.Mileage.toString())>=0&&this.filterOptionsWithRange.push(e.indexOf(i.Mileage.toString())),"slider"==this.settings.filterFieldLayouts.RequiredDownAmount.layout.toString()&&e.indexOf(i.RequiredDownAmount.toString())>=0&&this.filterOptionsWithRange.push(e.indexOf(i.RequiredDownAmount.toString())),"slider"==this.settings.filterFieldLayouts.CityMPG.layout.toString()&&e.indexOf(i.CityMPG.toString())>=0&&this.filterOptionsWithRange.push(e.indexOf(i.CityMPG.toString())),"slider"==this.settings.filterFieldLayouts.HighwayMPG.layout.toString()&&e.indexOf(i.HighwayMPG.toString())>=0&&this.filterOptionsWithRange.push(e.indexOf(i.HighwayMPG.toString())),this.filterOptionsWithRange.length>0)){var a=this.settings.priceMax;_.each(this.filterOptionsWithRange,function(e){var r=t.sortedOptions[e].length,n=t.sortedOptions[e][0].OptionType;if("undefined"!==$.type(t.sortedOptions[e][0].Value)){if(n==i.Year){var l=1;if(t.sortedOptions[e][0].Value>t.sortedOptions[e][r-1].Value)var o=t.sortedOptions[e][r-1].Value,s=t.sortedOptions[e][0].Value;else o=t.sortedOptions[e][0].Value,s=t.sortedOptions[e][r-1].Value}else{var d=t.sortedOptions[e][0].Value.split("-"),p=(l=parseInt(d[1])-parseInt(d[0]),t.sortedOptions[e][r-1].Value.split("-"));o=d[0],s=p[1];n==i.Price&&a>s&&""!=a&&(s=a)}n==i.RequiredDownAmount&&(r=2),t.sortedOptions[e]=[{usingSliderOption:!0,disableSliderOption:1==r,optionType:n,Interval:l,minValue:o,maxValue:s,key:e}]}})}},t.prototype.hookupVehicleListingButton=function(){var e=this;$(".dws-vehicle-listing-widget .dws-vehicle-listing-filter-btn").click(function(){var t="DWS_Async_Vehicle_Listing_Filter_Modal_"+e.elementId,i=$("<div></div>").addClass("dws-async-vehicle-listing-filter-container").attr("id",t),a=$("<div></div>").append(i);if(e.renderIntoContainer(i,!0),"NHT-V2"==e.settings.customTheme)var r="REFINE YOUR SEARCH";else r="Vehicle Filter";eModal.alert(a,r).then(function(){e.createSliderHandle(!0)})}).removeClass("hidden")},t.prototype.createSliderHandle=function(t){var a=this;void 0===t&&(t=!1),this.filterOptionsWithRange.length>0&&_.each(this.filterOptionsWithRange,function(r){if(t)var n="#DWS_Async_Vehicle_Listing_Filter_Modal_"+a.elementId+" #emodal-sliderhandler-filter-key-"+r;else n="#DWS_Async_Vehicle_Listing_filter_"+a.elementId+" #filter-key-"+r;var l,o=$(n).attr("data-filter-option-type"),s=$(n).attr("data-slider-enabled"),d=function(t){var a="";switch(parseInt(o)){case i.Year:a=a=s?t[0]:t[0]+" - "+t[1];break;case i.Price:void 0!==t[0]&&(a+="$"+e.WebSite.Common.Utils.formatWithSeparator(t[0].toString())+" - "),void 0!==t[1]&&(a+="$"+e.WebSite.Common.Utils.formatWithSeparator(t[1].toString()));break;case i.Mileage:case i.CityMPG:case i.HighwayMPG:case i.RequiredDownAmount:void 0!==t[0]&&(a+=e.WebSite.Common.Utils.formatWithSeparator(t[0].toString())+" - "),void 0!==t[1]&&(a+=e.WebSite.Common.Utils.formatWithSeparator(t[1].toString()))}return a};$(n).slider({formatter:d}),$(n).on("change",function(e){if(clearTimeout(l),l=setTimeout(function(){if(a.createUpdateButtonForSliderTracker(t,e),1==a.settings.monthlyPaymentCalculator&&i.Price==parseInt(o)){var r="#DWS_Async_Vehicle_Listing_filter_"+a.elementId;t&&(r="#DWS_Async_Vehicle_Listing_Filter_Modal_"+a.elementId);var n=$(r+" .dws-monthly-payment-calculator-term-wrapper");n.length>0&&(n.css({"margin-top":"60px"}),"layout_1"==a.settings.vehicleFilterLayout&&0==t&&n.css({"margin-top":"15px"}));var l=a.getCurrentPathAndcurrentQuery(),s=l.currentPath,d=l.currentQuery;null!=d?d+="&":d="";var p=s+(null==d?"":"?"+d),c="",u=p,m=e.currentTarget.nextElementSibling.id;$(r+" #"+m).hasClass("btn-update-price")&&(u=a.updateMonthlyPaymentButtonHref(p,u,c,r)),$(r+" #"+m).attr("href",u)}},100),"layout_1"==a.settings.vehicleFilterLayout?a.filterSliderEvent=!0:a.filterSliderEvent=!1,"change"==e.type&&e.value){var r=parseInt(e.currentTarget.getAttribute("data-filter-option-type")),n=e.currentTarget.parentElement,s=e.value.newValue[0],d=e.value.newValue[1],p=n.querySelector(".dws-vehicle-filter-slider-value-min"),c=n.querySelector(".dws-vehicle-filter-slider-value-max");null!==p&&null!=c&&(p.innerHTML=a.formatFilterLabels(r,s),c.innerHTML=a.formatFilterLabels(r,d))}}),$(n).trigger("change")})},t.prototype.updateMonthlyPaymentButtonHref=function(e,t,i,a){var r=$(a+" .dws-monthly-payment-calculator-wrapper"),n=$(a+" .dws-monthly-payment-calculator-term-wrapper"),l=r.find(".dws-monthly-payment-calculator-price-min"),o=r.find(".dws-monthly-payment-calculator-price-max"),s=l.text().replace(/\$|,/g,""),d=o.text().replace(/\$|,/g,""),p=r.find(".dws-monthly-payment-calculator-payment-max-field"),c=r.find(".dws-monthly-payment-calculator-payment-min-field"),u=p.text().replace(/\$|,/g,""),m=c.text().replace(/\$|,/g,""),h=n.find(".dws-term-monthly").text(),g=n.find(".dws-term-apr").text(),y=n.find(".dws-term-down").text().replace(/\$|,/g,"");return e.indexOf("price_min")>0||e.indexOf("price_max")>0?(t=t.replace(/(price_min=)[^\&]+/,"$1"+s.toString()),t=t.replace(/(price_max=)[^\&]+/,"$1"+d.toString())):i="&price_min="+s+"&price_max="+d,e.indexOf("monthly_payment_max")>0||e.indexOf("monthly_payment_min")>0?(t=t.replace(/(monthly_payment_min=)[^\&]+/,"$1"+m.toString()),t=t.replace(/(monthly_payment_max=)[^\&]+/,"$1"+u.toString())):i+="&monthly_payment_min="+m+"&monthly_payment_max="+u,e.indexOf("apr")>0?t=t.replace(/(apr=)[^\&]+/,"$1"+g.toString()):i+="&apr="+g,e.indexOf("cash_down")>0?t=t.replace(/(cash_down=)[^\&]+/,"$1"+y.toString()):i+="&cash_down="+y,e.indexOf("term")>0?t=t.replace(/(term=)[^\&]+/,"$1"+h.toString()):i+="&term="+h,t=t+=i,t},t.prototype.createUpdateButtonForSliderTracker=function(t,a){var r=this;void 0===t&&(t=!1);var n=a.currentTarget.nextElementSibling.id;if(t)var l="#DWS_Async_Vehicle_Listing_Filter_Modal_"+this.elementId;else l="#DWS_Async_Vehicle_Listing_filter_"+this.elementId;var o=$(l+" .vehicle-filter-apply-button");(""==this.settings.applyFiltersButtonClass||o.is(":hidden"))&&$(l+" #"+n).show();var s=this.getCurrentPathAndcurrentQuery(),d=s.currentPath,p=s.currentQuery;null!=p?p+="&":p="";var c=d+(null==p?"":"?"+p),u="",m=c;$(l+" .dws-filter-slider-input").each(function(a,o){var s=$(o).data("filter-option-type"),d=$(o).val().split(","),p=$(o).val().split(",");d=d[0],p=p[1];var h=$(l+" #"+n).parent(),g=h.find(".dws-vehicle-filter-slider-value-min"),y=h.find(".dws-vehicle-filter-slider-value-max");switch(parseInt(s)){case i.Year:if($(l+" #"+n).hasClass("btn-update-year")){for(var f=r.settings.selectedYear,v=d;v<=p;v++)u+=v+",";$(o).data("slider-min")!=d||$(o).data("slider-max")!=p?(0!=f.length?m=m.replace(/(vehicle_year=)[^\&]+/,"$1"+encodeURIComponent(u.substring(0,u.length-1))):(u="&vehicle_year="+encodeURIComponent(u.substring(0,u.length-1)),m=m+=u),g.html(r.formatFilterLabels(parseInt(s),d.toString())),y.html(r.formatFilterLabels(parseInt(s),p.toString()))):m=m.replace(/(vehicle_year=)[^\&]+/,"$1")}break;case i.Price:if($(l+" #"+n).hasClass("btn-update-price")&&(c.indexOf("price_min")>0||c.indexOf("price_max")>0?(m=m.replace(/(price_min=)[^\&]+/,"$1"+d.toString()),m=m.replace(/(price_max=)[^\&]+/,"$1"+p.toString()),g.html(r.formatFilterLabels(parseInt(s),d.toString())),y.html(r.formatFilterLabels(parseInt(s),p.toString()))):(u="&price_min="+d+"&price_max="+p,m=m+=u,g.html(r.formatFilterLabels(parseInt(s),d.toString())),y.html(r.formatFilterLabels(parseInt(s),p.toString())))),1==r.settings.monthlyPaymentCalculator){var w="#DWS_Async_Vehicle_Listing_filter_"+r.elementId;t&&(w="#DWS_Async_Vehicle_Listing_Filter_Modal_"+r.elementId);var C=$(w+" .dws-monthly-payment-calculator-wrapper"),S=$(w+" .dws-monthly-payment-calculator-enabled .list-group-item .slider-horizontal");if(C.length>0){var _=C.find(".dws-monthly-payment-calculator-payment-min-field"),b=C.find(".dws-monthly-payment-calculator-payment-max-field"),x=e.WebSite.Common.Utils.formatWithSeparator(d.toString()),F=e.WebSite.Common.Utils.formatWithSeparator(p.toString());_.text("$"+x),b.text("$"+F),S.css({"margin-bottom":0}),r.updateMonthlyPaymentPrice(t)}}break;case i.Mileage:$(l+" #"+n).hasClass("btn-update-mileage")&&(c.indexOf("mileage_min")>0||c.indexOf("mileage_max")>0?(m=m.replace(/(mileage_min=)[^\&]+/,"$1"+d.toString()),m=m.replace(/(mileage_max=)[^\&]+/,"$1"+p.toString()),g.html(r.formatFilterLabels(parseInt(s),d.toString())),y.html(r.formatFilterLabels(parseInt(s),p.toString()))):(u="&mileage_min="+d+"&mileage_max="+p,m=m+=u));break;case i.CityMPG:$(l+" #"+n).hasClass("btn-update-city-mpg")&&(c.indexOf("city_mpg_min")>0||c.indexOf("city_mpg_max")>0?(m=m.replace(/(city_mpg_min=)[^\&]+/,"$1"+d.toString()),m=m.replace(/(city_mpg_max=)[^\&]+/,"$1"+p.toString()),g.html(r.formatFilterLabels(parseInt(s),d.toString())),y.html(r.formatFilterLabels(parseInt(s),p.toString()))):(u="&city_mpg_min="+d+"&city_mpg_max="+p,m=m+=u));break;case i.HighwayMPG:$(l+" #"+n).hasClass("btn-update-highway-mpg")&&(c.indexOf("highway_mpg_min")>0||c.indexOf("highway_mpg_max")>0?(m=m.replace(/(highway_mpg_min=)[^\&]+/,"$1"+d.toString()),m=m.replace(/(highway_mpg_max=)[^\&]+/,"$1"+p.toString()),g.html(r.formatFilterLabels(parseInt(s),d.toString())),y.html(r.formatFilterLabels(parseInt(s),p.toString()))):(u="&highway_mpg_min="+d+"&highway_mpg_max="+p,m=m+=u));break;case i.RequiredDownAmount:$(l+" #"+n).hasClass("btn-update-required-down")&&(c.indexOf("downpayment_min")>0||c.indexOf("downpayment_max")>0?(m=m.replace(/(downpayment_min=)[^\&]+/,"$1"+d.toString()),m=m.replace(/(downpayment_max=)[^\&]+/,"$1"+p.toString()),g.html(r.formatFilterLabels(parseInt(s),d.toString())),y.html(r.formatFilterLabels(parseInt(s),p.toString()))):(u="&downpayment_min="+d+"&downpayment_max="+p,m=m+=u))}}),$(l+" #"+n).attr("href",m)},t.prototype.createCollapsibleFilter=function(e,t,i){var a;void 0===i&&(i=""),"default"==i&&(a="glyphicon glyphicon-plus"),"arrow"==i&&(a="glyphicon glyphicon-menu-right");var r=$("<span></span>").addClass("toggle-collapsible-filter-options "+a);e.append(r),e.click(function(){t.slideToggle(),"default"==i&&r.toggleClass("glyphicon-plus glyphicon-minus"),"arrow"==i&&r.toggleClass("glyphicon-menu-right glyphicon-menu-down")})},t.prototype.createOptionValueElements=function(t,a){var r=this,n=this.getCurrentPathAndcurrentQuery(),l=n.currentPath,o=n.currentQuery,d=(a.replace(/\s+/g,""),t);if(this.settings.vehicleTypeToDisplay){var p=this.settings.vehicleTypeToDisplay.split(",").map(function(e){return e.trim()});d=t.filter(function(e){return p.includes(e.Value)})}return _.map(d,function(t){var n=l,d=o,p=r.createFilterUrlAndOptionText(t);if(null!=p.subFolder){var c=p.subFolder;(r.settings.isInVlpChildPage&&r.settings.makeSlugEqual||-1!==n.toLowerCase().indexOf(r.settings.currentMake.toLowerCase())&&-1!==c.toLowerCase().indexOf(r.settings.currentMake.toLowerCase()))&&(c=c.replace(r.settings.currentMake.toLowerCase()+"/","")),n=n+c+"/"}null!=p.filterUrl&&(null!=d?d+="&":d="",d+=p.filterUrl);var u=n+(null==d?"":"?"+d),m=$("<a></a>").html(p.optionText).attr("href",u).attr("aria-label","filter by "+a+": "+p.optionText).attr("rel","nofollow");for(var h in r.settings.useCheckboxesForSelectedFilterOptions)if(r.settings.useCheckboxesForSelectedFilterOptions[h].OptionType==t.OptionType&&r.settings.useCheckboxesForSelectedFilterOptions[h].Value){var g=$("<input></input>");g.attr("type","checkbox"),g.attr("id","filter-checkbox-"+t.Value),g.attr("data-url-parameter",p.urlParameter),g.attr("data-value2",t.Value2),g.attr("class","dws-filter-option-checkbox");var y=t.Value;if(t.OptionType==i.VehicleClass&&("1"===t.Value?y="new":"2"===t.Value?y="used":"3"===t.Value&&(y="certified")),t.OptionType==i.VehicleType){var f={1:"auto",2:"motorcycle",3:"atv",4:"watercraft",5:"snowmobile",6:"rv",7:"classiExotic",99:"other"};y=f[t.Value]||y}t.OptionType==i.Image&&g.text("Vehicle with images only"),g.attr("value",y),m.prepend(g);var v=r.processVehicleFilterGetCheckedOptionParameters(),w=r.settings.useCheckboxesForSelectedFilterOptions;for(var C in v)w.hasOwnProperty(C)&&r.settings.useCheckboxesForSelectedFilterOptions[C].OptionType==t.OptionType&&v[C].indexOf(y.toLowerCase())>=0&&(g.attr("checked","checked"),m.attr("class","vehicle-filter-selected-by-checkbox"));m.click(function(e){var a=r.settings.applyFiltersButtonDisplay;if("all_devices"!=a&&!("display_tablet"==a&&!r.isMobile||"display_mobile"==a&&r.isMobile)){var n=e.currentTarget.firstElementChild.defaultValue.toLowerCase(),o=e.currentTarget.firstElementChild.dataset.urlParameter,s=e.currentTarget.firstElementChild.dataset.value2;if(t.OptionType==i.Location){var d=o.split("|");o=d[0];var p=d[1]}if(r.settings.vehicleFilterGetParameters){var c=r.settings.vehicleFilterGetParameters[o];if(void 0!==c){if(c=c.replace(/\\/g,""),c=decodeURIComponent(c),t.OptionType==i.TransmissionDetail)var u=c.split("|");else u=c.split(",");var m=u.indexOf(n),h=r.processVehicleGetParameters(n,m,u,t.OptionType);if(r.settings.vehicleFilterGetParameters[o]=h,t.OptionType==i.Location){var g=r.settings.vehicleFilterGetParameters[p],y=g.split(","),f=y.indexOf(s),v=r.processVehicleGetParameters(s,f,u,t.OptionType);r.settings.vehicleFilterGetParameters[p]=v}C=r.buildQueryParameterForMultipleCheckBox();var w=l+C;void 0!==w&&""!=w&&(window.location.href=w)}else{var C=r.buildQueryParameterForMultipleCheckBox();!r.settings.isFrontPage||"make"!=o&&"model"!=o||(o=r.jsUcfirst(o)),t.OptionType==i.Location?C+="&"+o+"="+encodeURIComponent(n)+"&"+p+"="+encodeURIComponent(s):C+="&"+o+"="+encodeURIComponent(n);w=l+C;void 0!==w&&""!=w&&(window.location.href=w)}}else{if(!r.settings.isFrontPage||"make"!=o&&"model"!=o||(o=r.jsUcfirst(o)),t.OptionType==i.Location)w=l+"?"+o+"="+encodeURIComponent(n)+"&"+p+"="+encodeURIComponent(s);else w=l+"?"+o+"="+encodeURIComponent(n);void 0!==w&&""!=w&&(window.location.href=w)}}}),m.attr("href","javascript:void(0);"),0==t.Count&&"hide"}if(p.getPostDetailsBySlug&&(m.attr("attr-post-slug",t.Value),m.addClass("get-post-details-by-slug")),t.OptionType==i.Image)return $("<li></li>").addClass(r.listItemClass+" clearfix dws-filter-layout-link ").append(m);if(null!=p.optionChild){var S=$("<ul>").addClass("option-child-container");p.optionChild.forEach(function(t){var i=t.Value;i.indexOf("/")>=0&&(i=i.replace(/\//g,"-")),i=r.settings.replaceSpacesWithDash?e.WebSite.Common.Utils.replaceSpacesWithDash(s.slugify(i),!0):i,i=encodeURIComponent(i);var l=n+i.toLowerCase()+(null==d?"":"?"+d);r.settings.isFrontPage&&(l=n+(null==d?"":"?"+d+"&Model="+encodeURIComponent(t.Value)));var o=$("<li>"),p=$("<a>").html(t.Value).attr("href",l).attr("aria-label","filter by "+a+": "+t.Value).attr("rel","nofollow");p.append($("<span>").addClass("badge").html(t.Count.toString())),o.append(p),S.append(o)});var _="layout_2"!=r.settings.vehicleFilterLayout?r.settings.cascadeMenuAlignment:"",b=$("<li>").addClass(r.listItemClass+" clearfix dws-filter-layout-link vehicle-make-model-popup "+_),x=$("<span>").addClass("badge").append(t.Count.toString());return m.append(x),b.append(m),b.append(S),b}return $("<li></li>").addClass(r.listItemClass+" clearfix dws-filter-layout-link ").append(m.append($("<span></span>").addClass("badge").html(t.Count.toString())))})},t.prototype.processVehicleFilterGetCheckedOptionParameters=function(){var e={};for(var t in this.settings.vehicleFilterGetParameters){var i=this.settings.vehicleFilterGetParameters[t];if(i=i.toLowerCase(),"transmission_detail"!=t){var a=i.split(",");if("model"===t)for(var r=0;r<a.length;r++)a[r]=a[r].replace(/\\/g,"")}else a=i.split("|");e[t.toString()]=a}return e},t.prototype.createGroupPrimaryColorsPaletteMarkup=function(e,t){for(var a=this,r=this.getCurrentPathAndcurrentQuery(),n=r.currentPath,l=r.currentQuery,o=[],s=0;s<this.settings.primaryColorsListFOrVehicleColorFilter.length;s++)for(var d=0;d<e.length;d++){var p=this.settings.primaryColorsListFOrVehicleColorFilter[s];-1!==e[d].Value.toLowerCase().indexOf(this.settings.primaryColorsListFOrVehicleColorFilter[s].toLowerCase())&&(e[d].GroupColor=p.toUpperCase())}for(d=0;d<e.length;d++)void 0===e[d].GroupColor&&(e[d].GroupColor="OTHER");var c=_.groupBy(e,function(e){return e.GroupColor});for(s=0;s<this.settings.primaryColorsListFOrVehicleColorFilter.length;s++){var u=this.settings.primaryColorsListFOrVehicleColorFilter[s].toLowerCase(),m=this.settings.primaryColorsListFOrVehicleColorFilter[s].toUpperCase(),h="",g=null,y=0,f=u;if(void 0!==c[m]){for(var v=0;v<c[m].length;v++)h=c[m][v].OptionType,y+=c[m][v].Count,g=m,c[m][v].Value.toLowerCase()!=u&&(f+=","+c[m][v].Value.toLowerCase());o.push({OptionType:h,Count:y,Value:g,Value2:null,OptionChild:null,Href:f})}}return _.map(o,function(e){var r=n,o=l,s=null,d=a.createFilterUrlAndOptionText(e),p="";switch(e.OptionType.toString()){case i.ExteriorColor.toString():case i.ExteriorColorType.toString():p="exterior_color",s=p+"="+encodeURIComponent(e.Href).toLowerCase(),s=s+"&exterior_color_group="+encodeURIComponent(e.Value).toLowerCase();break;case i.InteriorColor.toString():case i.InteriorColorType.toString():p="interior_color",s=p+"="+encodeURIComponent(e.Href).toLowerCase(),s=s+"&interior_color_group="+encodeURIComponent(e.Value).toLowerCase()}if(null!=d.subFolder){var c=d.subFolder;(a.settings.isInVlpChildPage&&a.settings.makeSlugEqual||-1!==r.toLowerCase().indexOf(a.settings.currentMake.toLowerCase())&&-1!==c.toLowerCase().indexOf(a.settings.currentMake.toLowerCase()))&&(c=c.replace(a.settings.currentMake.toLowerCase()+"/","")),r=r+c+"/"}null!=s&&(null!=o?o+="&":o="",o+=s);var u=r+(null==o?"":"?"+o),m=$("<a></a>").html(d.optionText).attr("href",u).attr("aria-label","filter by "+t+": "+d.optionText),h=d.optionText.toLowerCase(),g=h.replace(/[^a-zA-Z ]/g,""),y=g.replace(/\s+/g,"-"),f="dws-"+y;m=$("<a></a>").html('<span title="'+d.optionText+" : "+e.Count.toString()+'" class="'+f+' dws-palette"></span>').attr("href",u).attr("aria-label","filter by "+t+": "+d.optionText).attr("rel","nofollow");return $("<li></li>").addClass(a.listItemClass+" clearfix dws-filter-layout-link dws-filter-palette-color-container").append(m.append($("<span></span>").addClass("badge").html(e.Count.toString())))})},t.prototype.createIconOptionElementsForBodyType=function(e,t,a,r){var n=this,l=$("<div></div>").addClass("dws-tab-layout-bodytype-field-container dws-tab-layout-filter-fields dws-filter-fields").append($(this.bodyTypeSvgIconTemplate)),o=null,s=$(".dws-tab-layout-bodytype-icon-option-container",l),d=$(".dws-tab-layout-bodytype-icon-list-option",l),p=$(".dws-tab-layout-bodytype-dropdown-option",l),c=this.getCurrentPathAndcurrentQuery(),u=c.currentPath,m=c.currentQuery,h=(a.replace(/\s+/g,""),_.map(e,function(e){var t=u,r=m,l=n.createFilterUrlAndOptionText(e);if(null!=l.subFolder){var s=l.subFolder;(n.settings.isInVlpChildPage&&n.settings.makeSlugEqual||-1!==t.toLowerCase().indexOf(n.settings.currentMake.toLowerCase())&&-1!==s.toLowerCase().indexOf(n.settings.currentMake.toLowerCase()))&&(s=s.replace(n.settings.currentMake.toLowerCase()+"/","")),t=t+s+"/"}null!=l.filterUrl&&(null!=r?r+="&":r="",r+=l.filterUrl);var d=t+(null==r?"":"?"+r),p=l.optionText.toLowerCase();p=p.replace(/\W+(?!$)/g,"-"),p=p.replace(/\W$/,"");var c=void 0!==n.settings.vehicleBodyTypeSvg[p]&&""!=n.settings.vehicleBodyTypeSvg[p].svg?n.settings.vehicleBodyTypeSvg[p].svg:"",h=void 0!==n.settings.vehicleBodyTypeSvg[p]&&""!=n.settings.vehicleBodyTypeSvg[p].url?$("<img></img>").attr("src",n.settings.vehicleBodyTypeSvg[p].url):$("<img></img>").attr("src",n.settings.vehicleBodyTypeSvg["no-image"].url);h.attr("alt",void 0!==n.settings.vehicleBodyTypeSvg[p]&&""!=n.settings.vehicleBodyTypeSvg[p].alt?n.settings.vehicleBodyTypeSvg[p].alt:l.optionText);var g=$("<a></a>").attr({href:d,"aria-label":"filter by "+a+": "+l.optionText,"data-vehicle-title":l.optionText}).attr("rel","nofollow");g.append(h),g.find("img").length>0&&g.append(c),l.getPostDetailsBySlug&&(g.attr("attr-post-slug",e.Value),g.addClass("get-post-details-by-slug"));var y=$("<div></div>").addClass("dws-list-option-value-container").append(g),f=$("<a></a>").attr({href:d,"aria-label":"filter by "+a+": "+l.optionText,"data-vehicle-title":l.optionText}).addClass("dws-body-type-name").text(l.optionText).attr("rel","nofollow");return o=(e.OptionType,i.Image,$("<li></li>").addClass("col-xs-6").append(y).append(f)),o})),g=h,y=null;r>0&&h.length>r&&(g=h.splice(0,r),y=h),d.append(g),s.append(d),null!=y&&y.length>0?_.each(y,function(e){p.append($("<option />").attr({value:e.find("a").text(),"data-url-parameter":e.find("a").attr("href")}).html(e.find("a").attr("data-vehicle-title")))}):$(".dws-tab-layout-bodytype-other-option-container",l).hide();var f=navigator.userAgent;return f.indexOf("MSIE ")>-1||f.indexOf("Trident/"),p.change(function(){var e=p.find("option:selected"),t=e.attr("data-url-parameter");window.location.href=t}),l},t.prototype.createDropdownOptionElementsForMakeModel=function(t,a,r){var n=this,l=this.getCurrentPathAndcurrentQuery(),o=l.currentPath,d=l.currentQuery,p=$("<div></div>").addClass("dws-tab-layout-makemodel-field-container dws-tab-layout-filter-fields dws-filter-fields").append($(this.makeModelSelectDropdownTemplate)),c="MakeModel"!=a?a:"Make";$(".dws-parent-dropdown",p).text(c);var u=$(".dws-tab-layout-makemodel-parent-dropdown",p).append("<option value=''>All "+c+"</option>"),m=$(".dws-tab-layout-makemodel-child-dropdown",p),h=$(".dws-tab-layout-makemodel-dropdown-button",p);u.change(function(e){e.preventDefault,$("option",m).filter(function(){$(this).parent("span").length&&$(this).unwrap()});var t=u.find("option:selected"),i=t.attr("data-url-parameter");""!=t.attr("value")&&(m.find("option:first-child").attr("data-parent-dropdown",t.text()),m.find("option:not([data-parent-dropdown='"+t.text()+"'])").wrap("<span>").parent("span").hide()),"MakeModel"!=a&&(window.location.href=i),h.attr("href",i)}),m.change(function(e){e.preventDefault;var t=m.find("option:selected"),i=t.attr("data-parent-dropdown");u.val(i),m.find("option:not([data-parent-dropdown='"+i+"'])").hide();var a=t.attr("data-url-parameter");h.attr("href",a)});var g=_.map(t,function(t){var a=o,r=d,l=n.createFilterUrlAndOptionText(t);if(null!=l.subFolder){var c=l.subFolder;(n.settings.isInVlpChildPage&&n.settings.makeSlugEqual||-1!==a.toLowerCase().indexOf(n.settings.currentMake.toLowerCase())&&-1!==c.toLowerCase().indexOf(n.settings.currentMake.toLowerCase()))&&(c=c.replace(n.settings.currentMake.toLowerCase()+"/","")),a=a+s.slugify(c)+"/"}null!=l.filterUrl&&(null!=r?r+="&":r="",r+=l.filterUrl);var g=a+(null==r?"":"?"+r);return t.OptionType==i.Image?u.append($("<option></option>").attr({"data-url-parameter":g,value:l.optionText}).addClass(n.listItemClass).append(l.optionText)):null!=l.optionChild?(l.optionChild.forEach(function(t){var i=n.settings.replaceSpacesWithDash?e.WebSite.Common.Utils.replaceSpacesWithDash(s.slugify(t.Value),!0):t.Value,o=a+i+(null==r?"":"?"+r),d=$("<option></option>").attr({"data-url-parameter":o,"data-parent-dropdown":l.optionText,value:t.Value});d.append(t.Value),m.append(d)}),u.append($("<option></option>").attr({"data-url-parameter":g,value:l.optionText}).addClass(n.listItemClass).append(l.optionText))):(u.append($("<option></option>").attr({"data-url-parameter":g,value:l.optionText}).addClass(n.listItemClass).append(l.optionText)),$(".dws-child-dropdown",p).hide(),m.hide(),h.hide()),p});return g},t.prototype.processVehicleGetParameters=function(e,t,a,r){if(r==i.TransmissionDetail)var n="|";else n=",";return t>=0?(a.splice(t,1),a.sort(),a.join(n)):(a.push(e),a.sort(),a.join(n))},t.prototype.buildQueryParameterForMultipleCheckBox=function(){var e="",t=0;for(var i in this.settings.vehicleFilterGetParameters)if(""!=this.settings.vehicleFilterGetParameters[i]){if(!this.settings.isFrontPage||"make"!=i&&"model"!=i)a=i;else var a=this.jsUcfirst(i);e+=0==t?"?":"&","model"==i&&(this.settings.vehicleFilterGetParameters[i]=this.settings.vehicleFilterGetParameters[i].replace(/\\/g,"")),e+=a+"="+encodeURIComponent(this.settings.vehicleFilterGetParameters[i].toLowerCase());var r=this.parseQueryStringValue();"exterior_color"==a&&void 0!==r.exterior_color_group&&(e+="&exterior_color_group="+encodeURIComponent(r.exterior_color_group.toLowerCase())),"interior_color"==a&&void 0!==r.interior_color_group&&(e+="&interior_color_group="+encodeURIComponent(r.interior_color_group.toLowerCase())),t++}return e},t.prototype.parseQueryStringValue=function(){for(var e,t=[],i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),a=0;a<i.length;a++)e=i[a].split("="),t.push(e[0]),t[e[0]]=e[1];return t},t.prototype.getCurrentPathAndcurrentQuery=function(){
var e=document.location.href.replace(/([?&])page_no=([^&]+)&?/,"$1").replace(/[?&]$/,""),t=e,i=null;if(e.indexOf("?")>0){var a=e.split("?");t=a[0],i=a[1]}return{currentPath:t,currentQuery:i}},t.prototype.createFilterUrlAndOptionText=function(t){t.OptionType==i.Model&&(t.Value=t.Value.replace(/\\/g,""));var a=encodeURIComponent(t.Value).toLowerCase(),r=13!=t.OptionType?t.Value:t.Value2,n=null,l=null,o=null,s=this.settings.isFrontPage,d=!1,p=t.OptionChild;switch(t.OptionType.toString()){case i.Year.toString():l="vehicle_year",n="vehicle_year="+a;break;case i.Make.toString():l="make",this.settings.replaceSpacesWithDash&&(d=!0),"NHT-V2"==this.settings.customTheme?n="make="+a:1==s?n="Make="+a:o=this.settings.replaceSpacesWithDash?e.WebSite.Common.Utils.replaceSpacesWithDash(decodeURIComponent(a),!0):a;break;case i.Model.toString():l="model",this.settings.replaceSpacesWithDash&&(d=!0),"NHT-V2"==this.settings.customTheme?n=(this.settings.preSelectedMake,"model="+a):""!=this.settings.preSelectedMake?1==s?n="Make="+encodeURIComponent(this.settings.preSelectedMake).toLowerCase()+"&Model="+a:(this.settings.replaceSpacesWithDash&&(a=e.WebSite.Common.Utils.replaceSpacesWithDash(decodeURIComponent(a),!0)),o=encodeURIComponent(this.settings.preSelectedMake).toLowerCase()+"/"+a):1==s?n="Model="+a:(a=decodeURIComponent(a),this.settings.useCheckboxesForSelectedFilterOptions.model.Value?this.settings.replaceSpacesWithDash&&(a=e.WebSite.Common.Utils.replaceSpacesWithDash(a,!0)):(a=e.WebSite.Common.Utils.replaceSpacesWithDash(a,!0),-1!==a.indexOf("/")&&(a=a.replace(/\//g,"-")),-1!==a.indexOf("'")&&(a=a.replace(/'/g,""))),o=a);break;case i.BodyType.toString():l="body_type",n=l+"="+a;break;case i.Price.toString():var c=a.split("-");n="price_min="+c[0]+"&price_max="+c[1];var u=r.split("-");r="$"+e.WebSite.Common.Utils.formatWithSeparator(u[0])+" - $"+e.WebSite.Common.Utils.formatWithSeparator(u[1]);break;case i.Drivetrain.toString():case i.DrivetrainType.toString():l="drive_train",n=l+"="+a;break;case i.Transmission.toString():l="transmission",n=l+"="+a;break;case i.TransmissionDetail.toString():l="transmission_detail",n=l+"="+a;break;case i.Mileage.toString():c=a.split("-");n="mileage_min="+c[0]+"&mileage_max="+c[1];u=r.split("-");r=e.WebSite.Common.Utils.formatWithSeparator(u[0])+" - "+e.WebSite.Common.Utils.formatWithSeparator(u[1]);break;case i.ExteriorColor.toString():case i.ExteriorColorType.toString():l="exterior_color",n=l+"="+a;break;case i.InteriorColor.toString():case i.InteriorColorType.toString():l="interior_color",n=l+"="+a;break;case i.HighwayMPG.toString():c=a.split("-");n="highway_mpg_min="+c[0]+"&highway_mpg_max="+c[1];u=r.split("-");r=u[0]+" - "+u[1];break;case i.CityMPG.toString():c=a.split("-");n="city_mpg_min="+c[0]+"&city_mpg_max="+c[1];u=r.split("-");r=u[0]+" - "+u[1];break;case i.VehicleClass.toString():l="vehicle_class","1"===r?(r="NEW",n=l+"=new"):"2"===r?(r="USED",n=l+"=used"):"3"===r&&(r="CERTIFIED",n=l+"=certified");break;case i.Location.toString():var m=t.Value,h=this.settings.customLocationLabel[m];l="location|dealername",void 0!==h&&null!=h&&""!=h?(r=h,n="location="+a+"&dealername="+encodeURIComponent(r).toLowerCase()):n="location="+a+"&dealername="+encodeURIComponent(t.Value2).toLowerCase();break;case i.Cylinder.toString():l="cylinder",n=l+"="+a;break;case i.Displacement.toString():l="displacement",n=l+"="+a;break;case i.VehicleLocation.toString():l="vehicle_location",n=l+"="+a;break;case i.MakeModel.toString():l="make",this.settings.replaceSpacesWithDash&&(d=!0),"NHT-V2"==this.settings.customTheme?n="make="+a:1==s?n="Make="+a:o=this.settings.replaceSpacesWithDash?e.WebSite.Common.Utils.replaceSpacesWithDash(decodeURIComponent(a),!0):a;break;case i.Image.toString():l="vehicle_image",r="Vehicle with images only",n=l+"="+a;break;case i.FuelType.toString():l="fuel_type",n=l+"="+a;break;case i.RequiredDownAmount.toString():c=a.split("-");n="downpayment_min="+c[0]+"&downpayment_max="+c[1];u=r.split("-");r="$"+e.WebSite.Common.Utils.formatWithSeparator(u[0])+" - $"+e.WebSite.Common.Utils.formatWithSeparator(u[1]);break;case i.TitleBrand.toString():l="title_brand",n="title_brand="+a;break;case i.CustomStatus.toString():l="custom_status",n="custom_status="+a;break;case i.Status.toString():l="status",n="status="+a;break;case i.Equipment.toString():l="equipment",n="equipment="+a;break;case i.AutoCheck.toString():l="autocheck",n="autocheck="+a;break;case i.VehicleType.toString():l="vehicle_type";for(var g={1:"Auto",2:"Motorcycle",3:"ATV",4:"Watercraft",5:"Snowmobile",6:"RV",7:"Classic Exotic",99:"Other"},y=0,f=Object.entries(g);y<f.length;y++){var v=f[y],w=v[0],C=v[1];w==t.Value&&(r=C,n="vehicle_type="+C.toLowerCase())}break;case i.CoachDesign.toString():l="coach_design",n="coach_design="+a;break;case i.FloorPlan.toString():l="floor_plan",n="floor_plan="+a;break;case i.NumberOfSlideouts.toString():l="number_of_slideouts",n="number_of_slideouts="+a;break;case i.SleepingCount.toString():l="sleeping_count",n="sleeping_count="+a}return{filterUrl:n,subFolder:o,optionText:r,urlParameter:l,getPostDetailsBySlug:d,optionChild:p}},t.renderVehicleListingFilter=function(e,i){i=i.filter(function(e){return e.Count>0}),$(function(){try{new t(e,i).render()}catch(e){console.log(e)}})},t.prototype.jsUcfirst=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.prototype.roundNearestThousand=function(e){var t=isNaN(e)?0:e,i=1e3*Math.round(t/1e3);return i},t.prototype.encodeURIComponentWithPlus=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},t.prototype.formatFilterLabels=function(t,a){var r="";switch(t){case i.Price:r="$"+e.WebSite.Common.Utils.formatWithSeparator(a.toString());break;case i.Mileage:case i.HighwayMPG:case i.CityMPG:r=e.WebSite.Common.Utils.formatWithSeparator(a.toString());break;case i.RequiredDownAmount:r="$"+e.WebSite.Common.Utils.formatWithSeparator(a.toString());break;default:r=a.toString()}return r},t.maxItemToShow=5,t.filterOptions=t.populateFilterOptionDetail(),t}();t.AsyncVehicleListingFilter=a})(t.Plugins||(t.Plugins={}))})(e.WebSite||(e.WebSite={}))})(DealerCenter||(DealerCenter={}));