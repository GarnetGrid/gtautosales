class VlpTracker{constructor(){this.initTrackingData=(e=>{this.vin="undefined"!==e.attr("data-vehicle-vin")?e.attr("data-vehicle-vin"):"",this.sno="undefined"!==e.attr("data-vehicle-sno")?e.attr("data-vehicle-sno"):""}),this.cleanupTrackingData=(()=>{delete this.vin,delete this.sno}),this.bindCloudflareEvents=(e=>{e.addEventListener("play",this.onPlaying),e.addEventListener("pause",this.onPaused),e.addEventListener("loadeddata",this.onLoadedData),e.addEventListener("ended",this.onEnded),e.addEventListener("error",this.onError),e.addEventListener("stalled",this.onStalled),e.addEventListener("suspended",this.onSuspended)}),this.unBindCloudflareEvents=(e=>{e.removeEventListener("play",this.onPlaying),e.removeEventListener("pause",this.onPaused),e.removeEventListener("loadeddata",this.onLoadedData),e.removeEventListener("ended",this.onEnded),e.removeEventListener("error",this.onError),e.removeEventListener("stalled",this.onStalled),e.removeEventListener("suspended",this.onSuspended)}),this.bindFyuEvents=(()=>{"undefined"!=typeof fyuViewer&&(fyuViewer.On("complete",this.fyuComplete),fyuViewer.On("update",this.fyuUpdate),fyuViewer.On("error",this.fyuError))}),this.onPlaying=(e=>{let t={vid:e.srcElement.attributes.src.value};this.trackPlayerEvent("vidplay",t,this.sno,this.vin)}),this.onPaused=(e=>{let t={vid:e.srcElement.attributes.src.value};this.trackPlayerEvent("vidpause",t,this.sno,this.vin)}),this.onLoadedData=(e=>{let t={vid:e.srcElement.attributes.src.value};this.trackPlayerEvent("vidld",t,this.sno,this.vin)}),this.onEnded=(e=>{let t={vid:e.srcElement.attributes.src.value};this.trackPlayerEvent("vidended",t,this.sno,this.vin)}),this.onError=(e=>{let t={vid:e.srcElement.attributes.src.value};this.trackPlayerEvent("viderror",t,this.sno,this.vin)}),this.onStalled=(e=>{let t={vid:e.srcElement.attributes.src.value};this.trackPlayerEvent("vidstalled",t,this.sno,this.vin)}),this.onSuspended=(e=>{let t={vid:e.srcElement.attributes.src.value};this.trackPlayerEvent("vidsuspend",t,this.sno,this.vin)}),this.fyuComplete=(e=>{let t={vid:e.fid};this.trackPlayerEvent("f360cmplt",t,this.sno,this.vin)}),this.fyuUpdate=(e=>{let t={vid:e.fid};this.trackPlayerEvent("f360update",t,this.sno,this.vin)}),this.fyuError=((e,t)=>{let i={vid:e.fid,error:t};this.trackPlayerEvent("f360error",i,this.sno,this.vin)})}init(){this.initPlayerEventBindings(),this.initPlayerEventUnbindings(),this.initEventTracking()}initPlayerEventBindings(){let e=this;$("#dwsVideoModal, #dws360ImageModal").on("shown.bs.modal",function(){let t=$(this).find(".cf_container iframe"),i=$(this).find(".cf_container"),n=$(this).find(".fyu_container");if(1==t.length){let n=t.contents().find("stream")[0];void 0!==n&&(e.initTrackingData(i),e.bindCloudflareEvents(n))}1==n.length&&(e.initTrackingData(n),e.bindFyuEvents())})}initPlayerEventUnbindings(){let e=this;$("#dwsVideoModal, #dws360ImageModal").on("hidden.bs.modal",function(){let t=$(this).find(".cf_container iframe"),i=$(this).find(".fyu_container");if(1==t.length){let i=t.contents().find("stream")[0];void 0!==i&&e.unBindCloudflareEvents(i)}1==i.length&&e.unBindFyuEvents(),e.cleanupTrackingData()})}initEventTracking(){$(document).ready(function(){const e=new URLSearchParams(window.location.search),t=window.location.pathname.split("/").filter(e=>e);let i=null,n=null;if(2===t.length?i=decodeURIComponent(t[1]):t.length>=3&&(i=decodeURIComponent(t[1]),n=decodeURIComponent(t[2])),["vehicle_year","make","model","mileage_min","mileage_max","body_type","price_min","price_max","city_mpg_min","city_mpg_max","highway_mpg_min","highway_mpg_max","exterior_color","interior_color","keyword","equipment","drive_train","transmission","fuel_type"].some(t=>{const i=e.get(t);return null!==i&&""!==i.trim()})||i||n){let t=1;e.get("keyword")?t=6:e.get("city_mpg_min")||e.get("city_mpg_max")||e.get("highway_mpg_min")||e.get("highway_mpg_max")||e.get("fuel_type")?t=3:e.get("equipment")||e.get("drive_train")||e.get("transmission")||e.get("body_type")?t=2:e.get("exterior_color")||e.get("interior_color")?t=4:(e.get("price_min")||e.get("price_max")||e.get("mileage_min")||e.get("mileage_max"))&&(t=5);const p=e.get("mileage_min"),y=e.get("mileage_max");let _=null;p&&y&&(_=`${p}-${y}`);const f=e.get("price_min"),E=e.get("price_max");let C=null;f&&E&&(C=`${f}-${E}`);const w=e.get("city_mpg_min"),k=e.get("city_mpg_max"),b=e.get("highway_mpg_min"),S=e.get("highway_mpg_max");let D=null,T=null;w&&k&&(D=`${w}-${k}`),b&&S&&(T=`${b}-${S}`);var r=DealerCenter.WebSite.Common.Utils.readOrAssignClientId(!1),a=DealerCenter.WebSite.Common.Utils.ReadOrAssignSessionCookie(!1),s=decodeURIComponent(DealerCenter.WebSite.Common.Utils.getCookie("dws-trs")),o=decodeURIComponent(DealerCenter.WebSite.Common.Utils.getCookie("dws-ts-js")),l=decodeURIComponent(DealerCenter.WebSite.Common.Utils.getCookie("dws_geo_ip")),d=null;if(""!=s)d=JSON.parse(s).RF;var c=window.location.origin+window.location.pathname,m=null,u=null,h=null,g=null,v=null;if(o&&""!==o)o.split("|").forEach(function(e){var t=e.split("=");if(2===t.length){var i=t[0],n=t[1];switch("(direct)"!==n&&"(none)"!==n&&"(not set)"!==n||(n=null),i){case"utmcsr":m=n;break;case"utmcmd":u=n;break;case"utmccn":h=n;break;case"utmcct":g=n;break;case"utmctr":v=n}}});const P={eventTypeID:t,year:e.get("vehicle_year")||null,make:e.get("make")||i||null,model:e.get("model")||n||null,mileage:_,bodyType:e.get("body_type")||null,price:C,cityMpg:D,highwayMpg:T,exteriorColor:e.get("exterior_color")||null,interiorColor:e.get("interior_color")||null,keywordSearch:e.get("keyword")||null,equipment:e.get("equipment")||null,driveTrain:e.get("drive_train")||null,transmission:e.get("transmission")||null,fuelType:e.get("fuel_type")||null,session:{dcCompanyId:DWS_DCID,blogId:DWS_BLOG_ID,referer:d,ipAddress:l,applicantCid:r,applicantSid:a,landingUrl:c,sourceMedian:o,utmSource:m,utmMedium:u,utmCampaign:h,utmContent:g,utmTerm:v}};$.ajax({url:DWS_TRACKING_SITE+"/collect/event",type:"POST",cache:!1,contentType:"application/json",dataType:"json",data:JSON.stringify(P),error:(e,t,i)=>{console.log("[Event Tracker] Error: textStatus="+t+"|errorThrown="+i)}})}})}unBindFyuEvents(){"undefined"!=typeof fyuViewer&&fyuViewer.Destroy()}static fyuVisible(e){let t={vid:e.fid},i=new VlpTracker,n=$("#dws360ImageModal").find(".fyu_container");i.initTrackingData(n),i.trackPlayerEvent("f360vsbl",t,i.sno,i.vin)}trackPlayerEvent(e,t,i,n){var r=DealerCenter.WebSite.Common.Utils.readOrAssignClientId(!1),a=DealerCenter.WebSite.Common.Utils.ReadOrAssignSessionCookie(!1);$.ajax({url:DWS_TRACKING_SITE+"/collect",type:"GET",cache:!1,data:{t:e,n:JSON.stringify(t),r:document.referrer,cb:(new Date).getTime(),s:DWS_BLOG_ID,dcid:DWS_DCID,sno:i,vin:n,cid:r,sid:a},headers:{Accept:"image/webp,image/apng,image/*,*/*;q=0.8"},error:(e,t,i)=>{console.log("[Player Event Tracker] Error: textStatus="+t+"|errorThrown="+i)}})}}jQuery(()=>{(new VlpTracker).init()});